はい、承知いたしました。このChrome拡張機能「ダウンロードフォルダ振り分け」の操作方法などをまとめたドキュメントを作成します。

-----

**ダウンロードフォルダ振り分け拡張機能 - 操作マニュアル**

**1. 概要**

この拡張機能は、特定のウェブサイトやファイルの種類に基づいて、ダウンロードされるファイルを指定したサブフォルダに自動的に振り分けるためのツールです。ルールごとに優先度を設定でき、複数のルールに一致した場合でも意図した通りに動作させることが可能です。

**2. インストールとアクセス**

  * **インストール:** （Chromeウェブストアからインストールした場合、または開発者モードで .crx ファイルを読み込んだ場合）Chromeブラウザのツールバーに拡張機能のアイコン（例: \<img src="images/images\_square\_16x16.png" alt="拡張機能アイコン" style="display:inline-block; vertical-align:middle; width:16px; height:16px;"\>）が表示されます。
  * **設定画面へのアクセス:**
      * ツールバーの拡張機能アイコンをクリックすると、設定画面（ルール一覧画面）がポップアップで表示されます。
      * または、Chromeの拡張機能管理ページ (`chrome://extensions/`) から「ダウンロードフォルダ振り分け」の詳細を開き、「オプション」を選択しても設定画面にアクセスできます。

**3. 設定画面 (オプションページ) の見方**

設定画面では、ダウンロード振り分けルールの確認、追加、編集、削除、および有効/無効の切り替えができます。

  * **ヘッダー:** 画面上部には「ダウンロード振り分け設定」というタイトルが表示されます。
  * **ルール追加ボタン:** 「新しいルールを追加」ボタンをクリックすると、ルール作成・編集用のモーダルウィンドウが開きます。
  * **ルールリスト:** 現在設定されているルールがカード形式で一覧表示されます。ルールがない場合は、その旨のメッセージが表示されます。
  * **ステータスメッセージ:** ルールの保存や削除などの操作を行うと、画面上部に一時的に成功またはエラーのメッセージが表示されます。

**4. ルールの見方 (ルールカード)**

各ルールは以下の情報を含んでいます。

  * **サイトパターン (URLまたはキーワード):** ルールの対象となるウェブサイトのURLの一部、キーワード、または正規表現。
  * **有効/無効トグルスイッチ:** このルールが現在有効か無効かを示し、クリックで切り替えられます。
  * **マッチ種別:** サイトパターンの照合方法（部分一致、完全一致、正規表現）。
  * **保存先フォルダ:** ダウンロードファイルを保存するサブフォルダ名。空の場合はダウンロードフォルダのルートに保存されます。
  * **ファイルタイプ:** 対象とするファイルの拡張子（例: `pdf, docx, jpg`）。カンマ区切りで複数指定可能。空の場合は全てのファイルタイプが対象です。
  * **優先度:** 数値で指定し、数値が大きいほど優先的に適用されます。
  * **操作ボタン:**
      * **優先度を上げる/下げるボタン (↑/↓):** ルールの優先度を1段階変更します。
      * **編集ボタン (鉛筆アイコン):** ルールの内容を編集するためのモーダルウィンドウを開きます。
      * **削除ボタン (ゴミ箱アイコン):** ルールを削除します（確認ダイアログが表示されます）。

**5. ルールの追加と編集**

「新しいルールを追加」ボタン、または既存ルールの「編集ボタン」をクリックすると、以下の項目を設定するモーダルウィンドウが表示されます。

  * **サイトパターン (URLまたはキーワード):** (必須)
      * 例: `example.com` (このドメインからのダウンロード全て)
      * 例: `会議資料` (ファイル名やURLに「会議資料」という文字が含まれる場合)
      * 正規表現を使用する場合は、後述のマッチ種別で「正規表現」を選択してください。
  * **マッチ種別:**
      * **部分一致 (キーワードを含む):** (デフォルト) サイトパターンに入力した文字列がダウンロード元のURLに含まれていればマッチします。大文字・小文字は区別しません。
      * **完全一致 (URLが完全に一致):** サイトパターンに入力した文字列とダウンロード元のURLが完全に一致する場合にマッチします。
      * **正規表現 (高度なパターンマッチ):** サイトパターンに正規表現を記述して、より複雑な条件でマッチさせることができます。
  * **保存先フォルダ名:** (必須)
      * ダウンロードフォルダ内に作成されるサブフォルダ名を指定します。
      * 例: `仕事/プロジェクトA` (この場合、`仕事`フォルダの中に`プロジェクトA`フォルダが作成され、そこに保存されます)
      * フォルダ名に使用できない文字 (`< > : " / \ | ? * .` など) は自動的にアンダースコア (`_`) に置換されます。
  * **ファイルタイプ (カンマ区切り、任意):**
      * 特定のファイル拡張子のみを対象にしたい場合に指定します。ドット (`.`) は不要です。
      * 例: `pdf, docx, zip`
      * 空欄の場合は、全てのファイルタイプが対象となります。
  * **優先度 (数値):**
      * デフォルトは `0` です。数値が大きいほど、そのルールが優先的に適用されます。
      * 複数のルールに合致するダウンロードがあった場合、最も優先度の高いルールが1つだけ適用されます。

全ての項目を入力または選択し、「ルールを保存」ボタンをクリックすると、ルールが保存されリストに反映されます。「キャンセル」ボタンまたは右上の「×」ボタンでモーダルウィンドウを閉じることができます。

**6. ルールの並び順と優先度**

  * ルールリストには、優先度の高い順（優先度の数値が大きいものが上）にルールが表示されます。
  * 同じ優先度のルールが複数ある場合は、内部的なID（おおよそ作成順）に基づいて表示されます。
  * 実際のダウンロード振り分け処理も、この優先度に従って行われます。

**7. ルールの有効化/無効化**

各ルールカードの右上にあるトグルスイッチで、個々のルールの有効/無効を簡単に切り替えることができます。無効化されたルールは、ダウンロード振り分けの際に考慮されません。

**8. トラブルシューティング**

  * **ルールが期待通りに動作しない:**
      * サイトパターン、マッチ種別、ファイルタイプが正しく設定されているか確認してください。
      * 大文字・小文字の区別（部分一致の場合は区別しませんが、完全一致や正規表現の場合は意図通りか）。
      * 複数のルールに合致する可能性がある場合、優先度が適切に設定されているか確認してください。最も優先度の高いルールのみが適用されます。
      * 拡張機能が有効になっているか、Chromeの拡張機能管理ページで確認してください。
  * **設定画面が正しく表示されない、または操作できない:**
      * ブラウザのキャッシュをクリアしてみるか、一度拡張機能を無効化してから再度有効化してみてください。
      * （本マニュアル作成時点での情報として）もし画面からはみ出してルール作成ができない場合は、モーダルウィンドウ内またはページ全体でスクロールが可能です。

**9. アンインストール**

Chromeブラウザの拡張機能管理ページ (`chrome://extensions/`) から「ダウンロードフォルダ振り分け」を探し、「削除」ボタンをクリックすることでアンインストールできます。アンインストールすると、設定したルールもすべて削除されます。

-----

このマニュアルが、拡張機能のご利用の一助となれば幸いです。